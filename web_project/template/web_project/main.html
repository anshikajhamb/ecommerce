<!DOCTYPE html>

{% load static %}

<html>

    <head>
           <title>Art Buffs</title>

          <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1" />
          <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
          <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
          <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
          
          

        <script type="text/javascript">
          var user = '{{request.user}}'
//https://docs.djangoproject.com/en/3.2/ref/csrf/
//https://www.cssscript.com/simple-5-star-rating-system-with-css-and-html-radios/  

//csrf token
          function getToken(name) {
          let cookieValue = null;
          if (document.cookie && document.cookie !== '') {
              const cookies = document.cookie.split(';');
              for (let i = 0; i < cookies.length; i++) {
                  const cookie = cookies[i].trim();
                  // Does this cookie string begin with the name we want?
                  if (cookie.substring(0, name.length + 1) === (name + '=')) {
                      cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                      break;
            }
        }
    }
    return cookieValue;
}
const csrftoken = getToken('csrftoken');


//for guest user cart. this will create Cart variable in console. This we do so that we always have access to an empty cart despite the user being authenticated or not. 
      function getCookie(name) {
        var cookieArr= document.cookie.split(";");
            for (var i = 0; i < cookieArr.length; i++) {
              var cookiePair=cookieArr[i].split("=");

                  if (name== cookiePair[0].trim()){

                    return decodeURIComponent(cookiePair[1]);
                    
                  }


            }
    return null;
}
//converting JSON text to javascript object 
var cart = JSON.parse(getCookie('cart'))
if (cart == undefined) {
  cart={}
  console.log("cart was created")
  document.cookie = 'cart=' + JSON.stringify(cart) + ";domain=;path=/"
}
console.log('Cart:', cart)



//for guest wishlist 

 function getCookie(name) {
        var cookieArr= document.cookie.split(";");
            for (var i = 0; i < cookieArr.length; i++) {
              var cookiePair=cookieArr[i].split("=");

                  if (name== cookiePair[0].trim()){

                    return decodeURIComponent(cookiePair[1]);
                    
                  }


            }
    return null;
}
//converting JSON text to javascript object 
var wishlist = JSON.parse(getCookie('wishlist'))
if (wishlist == undefined) {
  wishlist={}
  console.log("wishlist was created")
  document.cookie = 'wishlist=' + JSON.stringify(wishlist) + ";domain=;path=/"
}
console.log('Wishlist:', wishlist)

    
        </script>



     </head>
     <body>


 <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="{% url 'home' %}"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
    <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
  </svg></a>
  <a class="navbar-brand" href="{% url 'store' %}"><strong>Art Buffs</strong></a>
  <a class="navbar-brand" href="{% url 'movies' %}">Movies</a>
  <a class="navbar-brand" href="{% url 'books' %}">Books</a>
  <a class="navbar-brand" href="{% url 'music' %}"> Music</a>
   
	  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
	    <span class="navbar-toggler-icon"></span>
	  </button>
  
  
      
<! this is for both search bar and autocomplete>
  
  <form action="{% url 'search' %}"  method="GET" class="d-flex">
  <input type="text" list="searchlist" name="search" id="search" placeholder="Search" aria-label="Search" class="form-control" required/>
  <datalist id="searchlist">
  {% for product in products%}
  <option value ="{{product.name}}">
  <option value ="{{product.categoryname}}">
   <option value ="{{product.price}}">

  {%endfor%}
  </datalist>

  <button class="btn btn-outline-success btn-sm " type="submit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
  </svg></button>
  
</form>



<div class="dropdown">
  <button class="btn btn-outline-success btn-sm  dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filter" viewBox="0 0 16 16">
      <path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"/>
    </svg>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
    <li><a class="dropdown-item" href="{% url 'sort_price' %}">Price: Low to High</a></li>
    <li><a class="dropdown-item" href="{% url 'sort_price_2' %}">Price: High to Low</a></li>
  </ul>
</div>

 <div class="collapse navbar-collapse" id="navbarSupportedContent">
	    <ul class="navbar-nav mr-auto">
	   </ul>
   <div class="form-inline my-2 my-lg-0">


  

<! Log In button will be displayed if user is not authenticated otherwise log out button displayed if they are>

			
{% if user_name %}
      <span> Hello, Anonymous User!   </span>
<div  id="login-button">
				<a  class="btn btn-outline-success" href="{% url 'login' %}">Login/Sign Up</a>
    </div>
{% else %}
	<a  class="btn btn-outline-success" href="{% url 'userprofile' %}"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-person" viewBox="0 0 16 16">
    <path d="M12 1a1 1 0 0 1 1 1v10.755S12 11 8 11s-5 1.755-5 1.755V2a1 1 0 0 1 1-1h8zM4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4z"/>
    <path d="M8 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
  </svg> </a>
<div id="logout-button">
				<a  class="btn btn-outline-success" href="{% url 'logout' %}">Logout</a>
    </div>
 {% endif %}

 
 <a  class="btn btn-outline-success" href="{% url 'about' %}">About</a>

 

      <a href="{% url 'wishlist' %}"> 
        <img  id="wishlist-icon" src="{% static 'img/wishlist.png' %}">

      </a>

      <p id="wishlist-total">{{wishlistItems}}</p>
     	
     	<a href="{% url 'cart' %}">
    		<img  id="cart-icon" src="{% static 'img/6+cart.png' %}">
    	</a>
    	<p id="cart-total">{{cartItems}}</p>
  </div>
   

</div>
         
</nav>






<div class="container">
            {% block content %}

            {% endblock content %}
  </div>
         
           

  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>

	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <script type="text/javascript" src="{% static 'js/cart.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/wishlist.js' %}"></script>
  


</head>
</head>
</body>
</html>






